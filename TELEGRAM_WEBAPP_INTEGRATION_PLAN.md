# ü§ñ –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram WebApp

## üìã **–û–ë–©–ê–Ø –õ–û–ì–ò–ö–ê –°–ò–°–¢–ï–ú–´**

**–£ –∫–∞–∂–¥–æ–≥–æ —Å–∞–ª–æ–Ω–∞ —Å–≤–æ–π –±–æ—Ç** - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–≥–æ –º—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. **–í–ª–∞–¥–µ–ª–µ—Ü —Å–∞–ª–æ–Ω–∞** —Å–æ–∑–¥–∞–µ—Ç –±–æ—Ç–∞ –≤ @BotFather
2. **–ü–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω** –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)
3. **–í–≤–æ–¥–∏—Ç —Ç–æ–∫–µ–Ω** –≤ –∞–¥–º–∏–Ω–∫–µ —Å–≤–æ–µ–≥–æ —Å–∞–ª–æ–Ω–∞
4. **–°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç** —Ç–æ–∫–µ–Ω –≤ –ø–æ–ª–µ `telegramBotToken` –¥–ª—è —ç—Ç–æ–≥–æ —Å–∞–ª–æ–Ω–∞
5. **WebApp –∏—Å–ø–æ–ª—å–∑—É–µ—Ç** –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### **URL —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- `https://test.2minutes.ru/book/salon-slug` - –∫–∞–∂–¥—ã–π —Å–∞–ª–æ–Ω –∏–º–µ–µ—Ç —Å–≤–æ–π slug
- –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–∞–ª–æ–Ω –ø–æ URL –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

---

## üéØ **–≠–¢–ê–ü–´ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò**

### **–≠–¢–ê–ü 1: Telegram WebApp API** ‚úÖ **–ß–ê–°–¢–ò–ß–ù–û –ì–û–¢–û–í–û**

**‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ API endpoint `/api/telegram/webapp-start` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç Telegram WebApp
- ‚úÖ –•—É–∫ `useTelegramWebApp` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö Telegram WebApp —á–µ—Ä–µ–∑ HMAC
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç Telegram WebApp
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ salon ID –∏–∑ URL –∏ startParam
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª–µ–π `telegramId`, `telegramUsername`, `telegramFirstName`, `telegramLastName` –≤ —Å—Ö–µ–º–µ –∫–ª–∏–µ–Ω—Ç–æ–≤

**‚ùå –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å:**
- ‚ùå Webhook –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Ç –±–æ—Ç–∞
- ‚ùå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ WebApp
- ‚ùå –°–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å Telegram ID

### **–≠–¢–ê–ü 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞** ‚úÖ **–ß–ê–°–¢–ò–ß–ù–û –ì–û–¢–û–í–û**

**‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ –∞–¥–º–∏–Ω–∫–µ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞ (`TelegramBotSettings` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
- ‚úÖ API –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–∞–ª–æ–Ω–∞
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ Telegram API
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ Telegram API
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –±–æ—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∞–ª–æ–Ω–∞

**‚ùå –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å:**
- ‚ùå –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º –±–æ—Ç–æ–º
- ‚ùå –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Mini App URL –≤ @BotFather
- ‚ùå –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–æ—Ç–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### **–≠–¢–ê–ü 3: –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** ‚ùå **–ù–ï –ù–ê–ß–ê–¢–û**

**‚ùå –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
- ‚ùå –°–æ–∑–¥–∞—Ç—å –æ—á–µ—Ä–µ–¥—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚ùå –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ Telegram Bot API
- ‚ùå –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è —Å–∞–ª–æ–Ω–æ–≤
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π

---

## üöÄ **–ü–†–ò–û–†–ò–¢–ï–¢–´ –î–õ–Ø –°–õ–ï–î–£–Æ–©–ò–• –®–ê–ì–û–í**

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (—Å—Ä–æ—á–Ω–æ):**
1. **–ó–∞–≤–µ—Ä—à–∏—Ç—å WebApp API** - –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –±–æ—Ç** - —Å–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ –≤ @BotFather –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
3. **Webhook –¥–ª—è –±–æ—Ç–∞** - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –æ—Ç –±–æ—Ç–∞

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2:**
4. **–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** - –±–∞–∑–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø–∏—Å—è—Ö

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3:**
6. **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

---

## üîß **–¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø**

### **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
```sql
-- –£ –∫–∞–∂–¥–æ–≥–æ —Å–∞–ª–æ–Ω–∞ –µ—Å—Ç—å —Å–≤–æ–π —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
model Team {
  telegramBotToken String? // —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ –¥–ª—è WebApp
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}
```

### **–í–∞–ª–∏–¥–∞—Ü–∏—è WebApp:**
```typescript
// –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–æ–º–∞–Ω–¥—ã
const team = await prisma.team.findFirst({
  where: { 
    OR: [
      { slug: teamSlug },
      { bookingSlug: teamSlug }
    ]
  },
  select: { telegramBotToken: true }
})

// –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–∫–µ–Ω –∏–º–µ–Ω–Ω–æ —ç—Ç–æ–≥–æ —Å–∞–ª–æ–Ω–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
const secretKey = crypto.createHmac('sha256', 'WebAppData').update(team.telegramBotToken).digest()
```

### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:**
‚úÖ **–ò–∑–æ–ª—è—Ü–∏—è** - –∫–∞–∂–¥—ã–π —Å–∞–ª–æ–Ω —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–≤–æ–∏–º –±–æ—Ç–æ–º –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —Ç–æ–∫–µ–Ω—ã –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è –º–µ–∂–¥—É —Å–∞–ª–æ–Ω–∞–º–∏  
‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∞–ª–æ–Ω–æ–≤  
‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π —Å–∞–ª–æ–Ω –º–æ–∂–µ—Ç –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ –ø–æ-—Å–≤–æ–µ–º—É  
‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è** - –≤–ª–∞–¥–µ–ª–µ—Ü —Å–∞–ª–æ–Ω–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏–º –±–æ—Ç–æ–º  

---

## üìù **–ó–ê–ú–ï–¢–ö–ò**

- **WebApp —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ Telegram** (–Ω–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
- **–ö–Ω–æ–ø–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å `web_app`**, –Ω–µ `url`
- **Mini App URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ @BotFather**
- **HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** –¥–ª—è WebApp
- **–ö–∞–∂–¥—ã–π —Å–∞–ª–æ–Ω = –æ–¥–∏–Ω –±–æ—Ç = –æ–¥–∏–Ω —Ç–æ–∫–µ–Ω**

---

*–°–æ–∑–¥–∞–Ω–æ: $(date)*
*–°—Ç–∞—Ç—É—Å: –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏*
